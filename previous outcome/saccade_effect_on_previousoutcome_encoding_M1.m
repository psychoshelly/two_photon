
load('L:\Monkey1\region1\20211108\unbiased_saccade_previousoutcome1108.mat');
load('L:\Monkey1\region1\20211109\unbiased_saccade_previousoutcome1109.mat');
load('L:\Monkey1\region1\20211110\unbiased_saccade_previousoutcome1110.mat');
load('L:\Monkey1\region1\20211111\unbiased_saccade_previousoutcome1111.mat');
load('L:\Monkey1\region1\20211112\unbiased_saccade_previousoutcome1112.mat');
load('L:\Monkey1\region1\20211113\unbiased_saccade_previousoutcome1113.mat');
load('L:\Monkey1\region1\20211115\unbiased_saccade_previousoutcome1115.mat');
load('L:\Monkey1\region1\20211116\unbiased_saccade_previousoutcome1116.mat');
load('L:\Monkey1\region1\20211117\unbiased_saccade_previousoutcome1117.mat');
load('L:\Monkey1\region1\20211118\unbiased_saccade_previousoutcome1118.mat');
load('L:\Monkey1\region1\20211119\unbiased_saccade_previousoutcome1119.mat');
load('L:\Monkey1\region1\20211122\unbiased_saccade_previousoutcome1122.mat');
load('L:\Monkey1\region2\20211120\unbiased_saccade_previousoutcome1120.mat');
load('L:\Monkey1\region2\20211121\unbiased_saccade_previousoutcome1121.mat');
load('L:\Monkey1\region2\20211123\unbiased_saccade_previousoutcome1123.mat');
load('L:\Monkey1\region2\20211124\unbiased_saccade_previousoutcome1124.mat');
load('L:\Monkey1\region3\20211125\unbiased_saccade_previousoutcome1125.mat');
load('L:\Monkey1\region3\20211126\unbiased_saccade_previousoutcome1126.mat');
load('L:\Monkey1\region3\20211127\unbiased_saccade_previousoutcome1127.mat');
load('L:\Monkey1\region4\20211129\unbiased_saccade_previousoutcome1129.mat');
load('L:\Monkey1\region4\20211201\unbiased_saccade_previousoutcome1201.mat');
load('L:\Monkey1\region4\20211202\unbiased_saccade_previousoutcome1202.mat');

load('L:\Monkey1\region5\20211203\unbiased_saccade_previousoutcome1203.mat');
load('L:\Monkey1\region5\20211204\unbiased_saccade_previousoutcome1204.mat');


load('L:\Monkey1\region6\20211217\unbiased_saccade_previousoutcome1217.mat');
load('L:\Monkey1\region6\20211218\unbiased_saccade_previousoutcome1218.mat');
load('L:\Monkey1\region6\20211219\unbiased_saccade_previousoutcome1219.mat');
load('L:\Monkey1\region6\20211220\unbiased_saccade_previousoutcome1220.mat');
load('L:\Monkey1\region6\20211221\unbiased_saccade_previousoutcome1221.mat');
load('L:\Monkey1\region6\20211222\unbiased_saccade_previousoutcome1222.mat');
load('L:\Monkey1\region6\20211223\unbiased_saccade_previousoutcome1223.mat');
load('L:\Monkey1\region6\20211224\unbiased_saccade_previousoutcome1224.mat');
load('L:\Monkey1\region6\20211225\unbiased_saccade_previousoutcome1225.mat');
load('L:\Monkey1\region6\20211226\unbiased_saccade_previousoutcome1226.mat');


load('L:\Monkey1\region7\20220115\unbiased_saccade_previousoutcome0115.mat');
load('L:\Monkey1\region7\20220116\unbiased_saccade_previousoutcome0116.mat');
load('L:\Monkey1\region7\20220117\unbiased_saccade_previousoutcome0117.mat');


% load('L:\Monkey2\region1\20220426\unbiased_saccade_previousoutcome0426.mat');
% load('L:\Monkey2\region1\20220427\unbiased_saccade_previousoutcome0427.mat');
% load('L:\Monkey2\region1\20220428\unbiased_saccade_previousoutcome0428.mat');
% load('L:\Monkey2\region1\20220429\unbiased_saccade_previousoutcome0429.mat');
% load('L:\Monkey2\region1\20220430\unbiased_saccade_previousoutcome0430.mat');
% load('L:\Monkey2\region1\20220501\unbiased_saccade_previousoutcome0501.mat');
% load('L:\Monkey2\region1\20220502\unbiased_saccade_previousoutcome0502.mat');

% 
% load('L:\Monkey2\region2\20220503\unbiased_saccade_previousoutcome0503.mat');
% load('L:\Monkey2\region2\20220504\unbiased_saccade_previousoutcome0504.mat');
% load('L:\Monkey2\region2\20220505\unbiased_saccade_previousoutcome0505.mat');
% load('L:\Monkey2\region2\20220506\unbiased_saccade_previousoutcome0506.mat');
% 
% load('L:\Monkey2\region3\20220507\unbiased_saccade_previousoutcome0507.mat');
% load('L:\Monkey2\region3\20220508\unbiased_saccade_previousoutcome0508.mat');
% load('L:\Monkey2\region3\20220509\unbiased_saccade_previousoutcome0509.mat');
% load('L:\Monkey2\region3\20220510\unbiased_saccade_previousoutcome0510.mat');
% load('L:\Monkey2\region3\20220511\unbiased_saccade_previousoutcome0511.mat');
% load('L:\Monkey2\region3\20220512\unbiased_saccade_previousoutcome0512.mat');
% load('L:\Monkey2\region3\20220513\unbiased_saccade_previousoutcome0513.mat');
% 
% load('L:\Monkey2\region4\20220517\unbiased_saccade_previousoutcome0517.mat');
% load('L:\Monkey2\region4\20220518\unbiased_saccade_previousoutcome0518.mat');
% load('L:\Monkey2\region4\20220519\unbiased_saccade_previousoutcome0519.mat');
% 
% load('L:\Monkey2\region5\20220524\unbiased_saccade_previousoutcome0524.mat');
% load('L:\Monkey2\region5\20220526\unbiased_saccade_previousoutcome0526.mat');
% load('L:\Monkey2\region5\20220527\unbiased_saccade_previousoutcome0527.mat');
% load('L:\Monkey2\region5\20220528\unbiased_saccade_previousoutcome0528.mat');
% load('L:\Monkey2\region5\20220529\unbiased_saccade_previousoutcome0529.mat');
% load('L:\Monkey2\region5\20220530\unbiased_saccade_previousoutcome0530.mat');
% 
% load('L:\Monkey2\region6\20220610\unbiased_saccade_previousoutcome0610.mat');
% load('L:\Monkey2\region6\20220611\unbiased_saccade_previousoutcome0611.mat');
% load('L:\Monkey2\region6\20220612\unbiased_saccade_previousoutcome0612.mat');
% load('L:\Monkey2\region6\20220613\unbiased_saccade_previousoutcome0613.mat');
% 
% load('L:\Monkey2\region7\20220618\unbiased_saccade_previousoutcome0618.mat');
% load('L:\Monkey2\region7\20220619\unbiased_saccade_previousoutcome0619.mat');
% load('L:\Monkey2\region7\20220620\unbiased_saccade_previousoutcome0620.mat');
% load('L:\Monkey2\region7\20220621\unbiased_saccade_previousoutcome0621.mat');
% load('L:\Monkey2\region7\20220622\unbiased_saccade_previousoutcome0622.mat');
% load('L:\Monkey2\region7\20220623\unbiased_saccade_previousoutcome0623.mat');

% load('L:\Monkey2\region8\20220624\unbiased_saccade_previousoutcome0624.mat');
% load('L:\Monkey2\region8\20220627\unbiased_saccade_previousoutcome0627.mat');
% load('L:\Monkey2\region8\20220628\unbiased_saccade_previousoutcome0628.mat');
% load('L:\Monkey2\region8\20220629\unbiased_saccade_previousoutcome0629.mat');
% load('L:\Monkey2\region8\20220630\unbiased_saccade_previousoutcome0630.mat');
unbiased_previous_left=[unbiased_previous_left1108;unbiased_previous_left1109;unbiased_previous_left1110;unbiased_previous_left1111;unbiased_previous_left1112;unbiased_previous_left1113;unbiased_previous_left1115;unbiased_previous_left1116;unbiased_previous_left1117;unbiased_previous_left1118;unbiased_previous_left1119;unbiased_previous_left1122;unbiased_previous_left1120;unbiased_previous_left1121;unbiased_previous_left1123;unbiased_previous_left1124;unbiased_previous_left1125;unbiased_previous_left1126;unbiased_previous_left1127;unbiased_previous_left1129;unbiased_previous_left1201;unbiased_previous_left1202;unbiased_previous_left1203;unbiased_previous_left1204;unbiased_previous_left1217;unbiased_previous_left1218;unbiased_previous_left1219;unbiased_previous_left1220;unbiased_previous_left1221;unbiased_previous_left1222;unbiased_previous_left1223;unbiased_previous_left1224;unbiased_previous_left1225;unbiased_previous_left1226;unbiased_previous_left0115;unbiased_previous_left0116;unbiased_previous_left0117];
unbiased_previous_right=[unbiased_previous_right1108;unbiased_previous_right1109;unbiased_previous_right1110;unbiased_previous_right1111;unbiased_previous_right1112;unbiased_previous_right1113;unbiased_previous_right1115;unbiased_previous_right1116;unbiased_previous_right1117;unbiased_previous_right1118;unbiased_previous_right1119;unbiased_previous_right1122;unbiased_previous_right1120;unbiased_previous_right1121;unbiased_previous_right1123;unbiased_previous_right1124;unbiased_previous_right1125;unbiased_previous_right1126;unbiased_previous_right1127;unbiased_previous_right1129;unbiased_previous_right1201;unbiased_previous_right1202;unbiased_previous_right1203;unbiased_previous_right1204;unbiased_previous_right1217;unbiased_previous_right1218;unbiased_previous_right1219;unbiased_previous_right1220;unbiased_previous_right1221;unbiased_previous_right1222;unbiased_previous_right1223;unbiased_previous_right1224;unbiased_previous_right1225;unbiased_previous_right1226;unbiased_previous_right0115;unbiased_previous_right0116;unbiased_previous_right0117];


shadedErrorBar(([1:40]-20)/7.4,mean(unbiased_previous_left(:,1:40),1),std(unbiased_previous_left(:,1:40),1)./sqrt(length(unbiased_previous_left(:,1:40))),'lineProps','r');
xline(0);
hold on
shadedErrorBar(([1:40]-20)/7.4,mean(unbiased_previous_right(:,1:40),1),std(unbiased_previous_right(:,1:40),1)./sqrt(length(unbiased_previous_right(:,1:40))),'lineProps','k');
legend('left','right');
ylim([0 0.01]);



p = kruskalwallis([mean(unbiased_previous_left(:,9:32),2)],[mean(unbiased_previous_right(:,9:32),2)],'off');



mean_unbiased_previous_left=mean(mean(unbiased_previous_left(:,9:32),2));
std_unbiased_previous_left=std(std(unbiased_previous_left(:,9:32),0,2))/sqrt(length(unbiased_previous_left));




mean_unbiased_previous_right=mean(mean(unbiased_previous_right(:,9:32),2));
std_unbiased_previous_right=std(std(unbiased_previous_right(:,9:32),0,2))/sqrt(length(unbiased_previous_right));



figure
bar(1,mean_unbiased_previous_left)
hold on
bar(2,mean_unbiased_previous_right)

hold on
errorbar(1,mean_unbiased_previous_left,std_unbiased_previous_left,'k');
hold on
errorbar(2,mean_unbiased_previous_right,std_unbiased_previous_right,'k');




load('L:\Monkey1\region1\20211108\proportions_of_cells_encoding_previous_trials_outcome_20211108_newmethod.mat');
iscell=readNPY('L:\Monkey1\region1\20211108\iscell.npy');
s1108=find(iscell(:,1)==1);
for i=1:length(M1region1day1)
unbiased_previous_left1108new(i,:)=unbiased_previous_left1108(find(s1108==M1region1day1(i,7)),:);
unbiased_previous_right1108new(i,:)=unbiased_previous_right1108(find(s1108==M1region1day1(i,7)),:);
end

load('L:\Monkey1\region1\20211109\proportions_of_cells_encoding_previous_trials_outcome_20211109_newmethod.mat');
iscell=readNPY('L:\Monkey1\region1\20211109\iscell.npy');
s1109=find(iscell(:,1)==1);
for i=1:length(M1region1day2)
unbiased_previous_left1109new(i,:)=unbiased_previous_left1109(find(s1109==M1region1day2(i,7)),:);
unbiased_previous_right1109new(i,:)=unbiased_previous_right1109(find(s1109==M1region1day2(i,7)),:);
end

load('L:\Monkey1\region1\20211110\proportions_of_cells_encoding_previous_trials_outcome_20211110_newmethod.mat');
iscell=readNPY('L:\Monkey1\region1\20211110\iscell.npy');
s1110=find(iscell(:,1)==1);
for i=1:length(M1region1day3)
unbiased_previous_left1110new(i,:)=unbiased_previous_left1110(find(s1110==M1region1day3(i,7)),:);
unbiased_previous_right1110new(i,:)=unbiased_previous_right1110(find(s1110==M1region1day3(i,7)),:);
end

load('L:\Monkey1\region1\20211111\proportions_of_cells_encoding_previous_trials_outcome_20211111_newmethod.mat');
iscell=readNPY('L:\Monkey1\region1\20211111\iscell.npy');
s1111=find(iscell(:,1)==1);
for i=1:length(M1region1day4)
unbiased_previous_left1111new(i,:)=unbiased_previous_left1111(find(s1111==M1region1day4(i,7)),:);
unbiased_previous_right1111new(i,:)=unbiased_previous_right1111(find(s1111==M1region1day4(i,7)),:);
end
load('L:\Monkey1\region1\20211112\proportions_of_cells_encoding_previous_trials_outcome_20211112_newmethod.mat');
iscell=readNPY('L:\Monkey1\region1\20211112\iscell.npy');
s1112=find(iscell(:,1)==1);

for i=1:length(M1region1day5)
unbiased_previous_left1112new(i,:)=unbiased_previous_left1112(find(s1112==M1region1day5(i,7)),:);
unbiased_previous_right1112new(i,:)=unbiased_previous_right1112(find(s1112==M1region1day5(i,7)),:);
end
load('L:\Monkey1\region1\20211113\proportions_of_cells_encoding_previous_trials_outcome_20211113_newmethod.mat');
iscell=readNPY('L:\Monkey1\region1\20211113\iscell.npy');
s1113=find(iscell(:,1)==1);

for i=1:length(M1region1day6)
unbiased_previous_left1113new(i,:)=unbiased_previous_left1113(find(s1113==M1region1day6(i,7)),:);
unbiased_previous_right1113new(i,:)=unbiased_previous_right1113(find(s1113==M1region1day6(i,7)),:);
end


load('L:\Monkey1\region1\20211115\proportions_of_cells_encoding_previous_trials_outcome_20211115_newmethod.mat');
iscell=readNPY('L:\Monkey1\region1\20211115\iscell.npy');
s1115=find(iscell(:,1)==1);
for i=1:length(M1region1day7)
unbiased_previous_left1115new(i,:)=unbiased_previous_left1115(find(s1115==M1region1day7(i,7)),:);
unbiased_previous_right1115new(i,:)=unbiased_previous_right1115(find(s1115==M1region1day7(i,7)),:);
end
load('L:\Monkey1\region1\20211116\proportions_of_cells_encoding_previous_trials_outcome_20211116_newmethod.mat');
iscell=readNPY('L:\Monkey1\region1\20211116\iscell.npy');
s1116=find(iscell(:,1)==1);
M1_region1_day8_6stages=union(union(union(union(union(M1region1stage1day8index,M1region1stage2day8index),M1region1stage3day8index),M1region1stage4day8index),M1region1stage5day8index),M1region1stage6day8index);
M1_region1_day8_0stage=setdiff(M1region1stage1day8diff_ratio_deltaF(:,1),M1_region1_day8_6stages);

for cell_num=1:length(M1_region1_day8_6stages)
    M1region1stage1day8_difference.(sprintf('cell_%d',cell_num))=mean(M1region1stage1day8_mean_ratio_deltaF_correctintegration.(sprintf('cell_%d',M1_region1_day8_6stages(cell_num))))-mean(M1region1stage1day8_mean_ratio_deltaF_wrongintegration.(sprintf('cell_%d',M1_region1_day8_6stages(cell_num))));
    M1region1stage1day8_difference_struct=cell2mat(struct2cell(M1region1stage1day8_difference));
    
    M1region1stage2day8_difference.(sprintf('cell_%d',cell_num))=mean(M1region1stage2day8_mean_ratio_deltaF_correctintegration.(sprintf('cell_%d',M1_region1_day8_6stages(cell_num))))-mean(M1region1stage2day8_mean_ratio_deltaF_wrongintegration.(sprintf('cell_%d',M1_region1_day8_6stages(cell_num))));
    M1region1stage2day8_difference_struct=cell2mat(struct2cell(M1region1stage2day8_difference));
    
    M1region1stage3day8_difference.(sprintf('cell_%d',cell_num))=mean(M1region1stage3day8_mean_ratio_deltaF_correctintegration.(sprintf('cell_%d',M1_region1_day8_6stages(cell_num))))-mean(M1region1stage3day8_mean_ratio_deltaF_wrongintegration.(sprintf('cell_%d',M1_region1_day8_6stages(cell_num))));
    M1region1stage3day8_difference_struct=cell2mat(struct2cell(M1region1stage3day8_difference));
    
    M1region1stage4day8_difference.(sprintf('cell_%d',cell_num))=mean(M1region1stage4day8_mean_ratio_deltaF_correctintegration.(sprintf('cell_%d',M1_region1_day8_6stages(cell_num))))-mean(M1region1stage4day8_mean_ratio_deltaF_wrongintegration.(sprintf('cell_%d',M1_region1_day8_6stages(cell_num))));
    M1region1stage4day8_difference_struct=cell2mat(struct2cell(M1region1stage4day8_difference));
    
     M1region1stage5day8_difference.(sprintf('cell_%d',cell_num))=mean(M1region1stage5day8_mean_ratio_deltaF_correctintegration.(sprintf('cell_%d',M1_region1_day8_6stages(cell_num))))-mean(M1region1stage5day8_mean_ratio_deltaF_wrongintegration.(sprintf('cell_%d',M1_region1_day8_6stages(cell_num))));
    M1region1stage5day8_difference_struct=cell2mat(struct2cell(M1region1stage5day8_difference));
    
    
     M1region1stage6day8_difference.(sprintf('cell_%d',cell_num))=mean(M1region1stage5day8_mean_ratio_deltaF_correctintegration.(sprintf('cell_%d',M1_region1_day8_6stages(cell_num))))-mean(M1region1stage6day8_mean_ratio_deltaF_wrongintegration.(sprintf('cell_%d',M1_region1_day8_6stages(cell_num))));
    M1region1stage6day8_difference_struct=cell2mat(struct2cell(M1region1stage5day8_difference));
    
    
end
M1region1day8=[M1region1stage1day8_difference_struct M1region1stage2day8_difference_struct M1region1stage3day8_difference_struct M1region1stage4day8_difference_struct M1region1stage5day8_difference_struct M1region1stage6day8_difference_struct M1_region1_day8_6stages];


for i=1:length(M1region1day8)
unbiased_previous_left1116new(i,:)=unbiased_previous_left1116(find(s1116==M1region1day8(i,7)),:);
unbiased_previous_right1116new(i,:)=unbiased_previous_right1116(find(s1116==M1region1day8(i,7)),:);
end


load('L:\Monkey1\region1\20211117\proportions_of_cells_encoding_previous_trials_outcome_20211117_newmethod.mat');
iscell=readNPY('L:\Monkey1\region1\20211117\iscell.npy');
s1117=find(iscell(:,1)==1);
for i=1:length(M1region1day9)
unbiased_previous_left1117new(i,:)=unbiased_previous_left1117(find(s1117==M1region1day9(i,7)),:);
unbiased_previous_right1117new(i,:)=unbiased_previous_right1117(find(s1117==M1region1day9(i,7)),:);
end

load('L:\Monkey1\region1\20211118\proportions_of_cells_encoding_previous_trials_outcome_20211118_newmethod.mat');
iscell=readNPY('L:\Monkey1\region1\20211118\iscell.npy');
s1118=find(iscell(:,1)==1);

for i=1:length(M1region1day10)
unbiased_previous_left1118new(i,:)=unbiased_previous_left1118(find(s1118==M1region1day10(i,7)),:);
unbiased_previous_right1118new(i,:)=unbiased_previous_right1118(find(s1118==M1region1day10(i,7)),:);
end


load('L:\Monkey1\region1\20211119\proportions_of_cells_encoding_previous_trials_outcome_20211119_newmethod.mat');
iscell=readNPY('L:\Monkey1\region1\20211119\iscell.npy');
s1119=find(iscell(:,1)==1);
for i=1:length(M1region1day11)
unbiased_previous_left1119new(i,:)=unbiased_previous_left1119(find(s1119==M1region1day11(i,7)),:);
unbiased_previous_right1119new(i,:)=unbiased_previous_right1119(find(s1119==M1region1day11(i,7)),:);
end

load('L:\Monkey1\region1\20211122\proportions_of_cells_encoding_previous_trials_outcome_20211122_newmethod.mat');
iscell=readNPY('L:\Monkey1\region1\20211122\iscell.npy');
s1122=find(iscell(:,1)==1);
for i=1:length(M1region1day12)
unbiased_previous_left1122new(i,:)=unbiased_previous_left1122(find(s1122==M1region1day12(i,7)),:);
unbiased_previous_right1122new(i,:)=unbiased_previous_right1122(find(s1122==M1region1day12(i,7)),:);
end

load('L:\Monkey1\region2\20211120\proportions_of_cells_encoding_previous_trials_outcome_20211120_newmethod.mat');
iscell=readNPY('L:\Monkey1\region2\20211120\iscell.npy');
s1120=find(iscell(:,1)==1);
for i=1:length(M1region2day1)
unbiased_previous_left1120new(i,:)=unbiased_previous_left1122(find(s1120==M1region2day1(i,7)),:);
unbiased_previous_right1120new(i,:)=unbiased_previous_right1122(find(s1120==M1region2day1(i,7)),:);
end

load('L:\Monkey1\region2\20211121\proportions_of_cells_encoding_previous_trials_outcome_20211121_newmethod.mat');
iscell=readNPY('L:\Monkey1\region2\20211121\iscell.npy');
s1121=find(iscell(:,1)==1);

for i=1:length(M1region2day2)
unbiased_previous_left1121new(i,:)=unbiased_previous_left1121(find(s1121==M1region2day2(i,7)),:);
unbiased_previous_right1121new(i,:)=unbiased_previous_right1121(find(s1121==M1region2day2(i,7)),:);
end


load('L:\Monkey1\region2\20211123\proportions_of_cells_encoding_previous_trials_outcome_20211123_newmethod.mat');
iscell=readNPY('L:\Monkey1\region2\20211123\iscell.npy');
s1123=find(iscell(:,1)==1);
for i=1:length(M1region2day3)
unbiased_previous_left1123new(i,:)=unbiased_previous_left1123(find(s1123==M1region2day3(i,7)),:);
unbiased_previous_right1123new(i,:)=unbiased_previous_right1123(find(s1123==M1region2day3(i,7)),:);
end

load('L:\Monkey1\region2\20211124\proportions_of_cells_encoding_previous_trials_outcome_20211124_newmethod.mat');
iscell=readNPY('L:\Monkey1\region2\20211124\iscell.npy');
s1124=find(iscell(:,1)==1);
for i=1:length(M1region2day4)
unbiased_previous_left1124new(i,:)=unbiased_previous_left1124(find(s1124==M1region2day4(i,7)),:);
unbiased_previous_right1124new(i,:)=unbiased_previous_right1124(find(s1124==M1region2day4(i,7)),:);
end
load('L:\Monkey1\region3\20211125\proportions_of_cells_encoding_previous_trials_outcome_20211125_newmethod.mat');
iscell=readNPY('L:\Monkey1\region3\20211125\iscell.npy');
s1125=find(iscell(:,1)==1);
for i=1:length(M1region3day1)
unbiased_previous_left1125new(i,:)=unbiased_previous_left1125(find(s1125==M1region3day1(i,7)),:);
unbiased_previous_right1125new(i,:)=unbiased_previous_right1125(find(s1125==M1region3day1(i,7)),:);
end

load('L:\Monkey1\region3\20211126\proportions_of_cells_encoding_previous_trials_outcome_20211126_newmethod.mat');
iscell=readNPY('L:\Monkey1\region3\20211126\iscell.npy');
s1126=find(iscell(:,1)==1);

for i=1:length(M1region3day2)
unbiased_previous_left1126new(i,:)=unbiased_previous_left1126(find(s1126==M1region3day2(i,7)),:);
unbiased_previous_right1126new(i,:)=unbiased_previous_right1126(find(s1126==M1region3day2(i,7)),:);
end

load('L:\Monkey1\region3\20211127\proportions_of_cells_encoding_previous_trials_outcome_20211127_newmethod.mat');
iscell=readNPY('L:\Monkey1\region3\20211127\iscell.npy');
s1127=find(iscell(:,1)==1);

for i=1:length(M1region3day3)
unbiased_previous_left1127new(i,:)=unbiased_previous_left1127(find(s1127==M1region3day3(i,7)),:);
unbiased_previous_right1127new(i,:)=unbiased_previous_right1127(find(s1127==M1region3day3(i,7)),:);
end
load('L:\Monkey1\region4\20211129\proportions_of_cells_encoding_previous_trials_outcome_20211129_newmethod.mat');
iscell=readNPY('L:\Monkey1\region4\20211129\iscell.npy');
s1129=find(iscell(:,1)==1);

for i=1:length(M1region4day1)
unbiased_previous_left1129new(i,:)=unbiased_previous_left1129(find(s1129==M1region4day1(i,7)),:);
unbiased_previous_right1129new(i,:)=unbiased_previous_right1129(find(s1129==M1region4day1(i,7)),:);
end
load('L:\Monkey1\region4\20211201\proportions_of_cells_encoding_previous_trials_outcome_20211201_newmethod.mat');
iscell=readNPY('L:\Monkey1\region4\20211201\iscell.npy');
s1201=find(iscell(:,1)==1);

for i=1:length(M1region4day2)
unbiased_previous_left1201new(i,:)=unbiased_previous_left1201(find(s1201==M1region4day2(i,7)),:);
unbiased_previous_right1201new(i,:)=unbiased_previous_right1201(find(s1201==M1region4day2(i,7)),:);
end



load('L:\Monkey1\region4\20211202\proportions_of_cells_encoding_previous_trials_outcome_20211202_newmethod.mat');
iscell=readNPY('L:\Monkey1\region4\20211202\iscell.npy');
s1202=find(iscell(:,1)==1);

for i=1:length(M1region4day3)
unbiased_previous_left1202new(i,:)=unbiased_previous_left1202(find(s1202==M1region4day3(i,7)),:);
unbiased_previous_right1202new(i,:)=unbiased_previous_right1202(find(s1202==M1region4day3(i,7)),:);
end


load('L:\Monkey1\region5\20211203\proportions_of_cells_encoding_previous_trials_outcome_20211203_newmethod.mat');
iscell=readNPY('L:\Monkey1\region5\20211203\iscell.npy');
s1203=find(iscell(:,1)==1);
for i=1:length(M1region5day1)
unbiased_previous_left1203new(i,:)=unbiased_previous_left1203(find(s1203==M1region5day1(i,7)),:);
unbiased_previous_right1203new(i,:)=unbiased_previous_right1203(find(s1203==M1region5day1(i,7)),:);
end
load('L:\Monkey1\region5\20211204\proportions_of_cells_encoding_previous_trials_outcome_20211204_newmethod.mat');
iscell=readNPY('L:\Monkey1\region5\20211204\iscell.npy');
s1204=find(iscell(:,1)==1);

for i=1:length(M1region5day2)
unbiased_previous_left1204new(i,:)=unbiased_previous_left1204(find(s1204==M1region5day2(i,7)),:);
unbiased_previous_right1204new(i,:)=unbiased_previous_right1204(find(s1204==M1region5day2(i,7)),:);
end


load('L:\Monkey1\region6\20211217\proportions_of_cells_encoding_previous_trials_outcome_20211217_newmethod.mat');
iscell=readNPY('L:\Monkey1\region6\20211217\iscell.npy');
s1217=find(iscell(:,1)==1);

for i=1:length(M1region6day1)
unbiased_previous_left1217new(i,:)=unbiased_previous_left1217(find(s1217==M1region6day1(i,7)),:);
unbiased_previous_right1217new(i,:)=unbiased_previous_right1217(find(s1217==M1region6day1(i,7)),:);
end

load('L:\Monkey1\region6\20211218\proportions_of_cells_encoding_previous_trials_outcome_20211218_newmethod.mat');
iscell=readNPY('L:\Monkey1\region6\20211218\iscell.npy');
s1218=find(iscell(:,1)==1);

for i=1:length(M1region6day2)
unbiased_previous_left1218new(i,:)=unbiased_previous_left1218(find(s1218==M1region6day2(i,7)),:);
unbiased_previous_right1218new(i,:)=unbiased_previous_right1218(find(s1218==M1region6day2(i,7)),:);
end
load('L:\Monkey1\region6\20211219\proportions_of_cells_encoding_previous_trials_outcome_20211219_newmethod.mat');
iscell=readNPY('L:\Monkey1\region6\20211219\iscell.npy');
s1219=find(iscell(:,1)==1);

for i=1:length(M1region6day3)
unbiased_previous_left1219new(i,:)=unbiased_previous_left1219(find(s1219==M1region6day3(i,7)),:);
unbiased_previous_right1219new(i,:)=unbiased_previous_right1219(find(s1219==M1region6day3(i,7)),:);
end

load('L:\Monkey1\region6\20211220\proportions_of_cells_encoding_previous_trials_outcome_20211220_newmethod.mat');
iscell=readNPY('L:\Monkey1\region6\20211220\iscell.npy');
s1220=find(iscell(:,1)==1);

for i=1:length(M1region6day4)
unbiased_previous_left1220new(i,:)=unbiased_previous_left1220(find(s1220==M1region6day4(i,7)),:);
unbiased_previous_right1220new(i,:)=unbiased_previous_right1220(find(s1220==M1region6day4(i,7)),:);
end
load('L:\Monkey1\region6\20211221\proportions_of_cells_encoding_previous_trials_outcome_20211221_newmethod.mat');
iscell=readNPY('L:\Monkey1\region6\20211221\iscell.npy');
s1221=find(iscell(:,1)==1);

for i=1:length(M1region6day5)
unbiased_previous_left1221new(i,:)=unbiased_previous_left1221(find(s1221==M1region6day5(i,7)),:);
unbiased_previous_right1221new(i,:)=unbiased_previous_right1221(find(s1221==M1region6day5(i,7)),:);
end

load('L:\Monkey1\region6\20211222\proportions_of_cells_encoding_previous_trials_outcome_20211222_newmethod.mat');
iscell=readNPY('L:\Monkey1\region6\20211222\iscell.npy');
s1222=find(iscell(:,1)==1);

for i=1:length(M1region6day6)
unbiased_previous_left1222new(i,:)=unbiased_previous_left1222(find(s1222==M1region6day6(i,7)),:);
unbiased_previous_right1222new(i,:)=unbiased_previous_right1222(find(s1222==M1region6day6(i,7)),:);
end

load('L:\Monkey1\region6\20211223\proportions_of_cells_encoding_previous_trials_outcome_20211223_newmethod.mat');
iscell=readNPY('L:\Monkey1\region6\20211223\iscell.npy');
s1223=find(iscell(:,1)==1);

for i=1:length(M1region6day7)
unbiased_previous_left1223new(i,:)=unbiased_previous_left1223(find(s1223==M1region6day7(i,7)),:);
unbiased_previous_right1223new(i,:)=unbiased_previous_right1223(find(s1223==M1region6day7(i,7)),:);
end
load('L:\Monkey1\region6\20211224\proportions_of_cells_encoding_previous_trials_outcome_20211224_newmethod.mat');
iscell=readNPY('L:\Monkey1\region6\20211224\iscell.npy');
s1224=find(iscell(:,1)==1);

for i=1:length(M1region6day8)
unbiased_previous_left1224new(i,:)=unbiased_previous_left1224(find(s1224==M1region6day8(i,7)),:);
unbiased_previous_right1224new(i,:)=unbiased_previous_right1224(find(s1224==M1region6day8(i,7)),:);
end
load('L:\Monkey1\region6\20211225\proportions_of_cells_encoding_previous_trials_outcome_20211225_newmethod.mat');
iscell=readNPY('L:\Monkey1\region6\20211225\iscell.npy');
s1225=find(iscell(:,1)==1);

for i=1:length(M1region6day9)
unbiased_previous_left1225new(i,:)=unbiased_previous_left1225(find(s1225==M1region6day9(i,7)),:);
unbiased_previous_right1225new(i,:)=unbiased_previous_right1225(find(s1225==M1region6day9(i,7)),:);
end
load('L:\Monkey1\region6\20211226\proportions_of_cells_encoding_previous_trials_outcome_20211226_newmethod.mat');
iscell=readNPY('L:\Monkey1\region6\20211226\iscell.npy');
s1226=find(iscell(:,1)==1);

for i=1:length(M1region6day10)
unbiased_previous_left1226new(i,:)=unbiased_previous_left1226(find(s1226==M1region6day10(i,7)),:);
unbiased_previous_right1226new(i,:)=unbiased_previous_right1226(find(s1226==M1region6day10(i,7)),:);
end

load('L:\Monkey1\region7\20220115\proportions_of_cells_encoding_previous_trials_outcome_20220115_newmethod.mat');
iscell=readNPY('L:\Monkey1\region7\20220115\iscell.npy');
s0115=find(iscell(:,1)==1);

for i=1:length(M1region7day1)
unbiased_previous_left0115new(i,:)=unbiased_previous_left0115(find(s0115==M1region7day1(i,7)),:);
unbiased_previous_right0115new(i,:)=unbiased_previous_right0115(find(s0115==M1region7day1(i,7)),:);
end
load('L:\Monkey1\region7\20220116\proportions_of_cells_encoding_previous_trials_outcome_20220116_newmethod.mat');
iscell=readNPY('L:\Monkey1\region7\20220116\iscell.npy');
s0116=find(iscell(:,1)==1);

for i=1:length(M1region7day2)
unbiased_previous_left0116new(i,:)=unbiased_previous_left0116(find(s0116==M1region7day2(i,7)),:);
unbiased_previous_right0116new(i,:)=unbiased_previous_right0116(find(s0116==M1region7day2(i,7)),:);
end
load('L:\Monkey1\region7\20220117\proportions_of_cells_encoding_previous_trials_outcome_20220117_newmethod.mat');
iscell=readNPY('L:\Monkey1\region7\20220117\iscell.npy');
s0117=find(iscell(:,1)==1);

for i=1:length(M1region7day3)
unbiased_previous_left0117new(i,:)=unbiased_previous_left0117(find(s0117==M1region7day3(i,7)),:);
unbiased_previous_right0117new(i,:)=unbiased_previous_right0117(find(s0117==M1region7day3(i,7)),:);
end


% load('L:\Monkey2\region1\20220426\proportions_of_cells_encoding_previous_trials_outcome_20220426_newmethod.mat');
% iscell=readNPY('L:\Monkey2\region1\20220426\iscell.npy');
% s0426=find(iscell(:,1)==1);
% 
% for i=1:length(M2region1day1)
% unbiased_previous_left0426new(i,:)=unbiased_previous_left0426(find(s0426==M2region1day1(i,7)),:);
% unbiased_previous_right0426new(i,:)=unbiased_previous_right0426(find(s0426==M2region1day1(i,7)),:);
% end
% 
% load('L:\Monkey2\region1\20220427\proportions_of_cells_encoding_previous_trials_outcome_20220427_newmethod.mat');
% iscell=readNPY('L:\Monkey2\region1\20220427\iscell.npy');
% s0427=find(iscell(:,1)==1);
% 
% for i=1:length(M2region1day2)
% unbiased_previous_left0427new(1,:)=unbiased_previous_left0427(find(s0427==M2region1day2(1,7)),:);
% unbiased_previous_right0427new(i,:)=unbiased_previous_right0427(find(s0427==M2region1day2(i,7)),:);
% end
% 
% load('L:\Monkey2\region1\20220428\proportions_of_cells_encoding_previous_trials_outcome_20220428_newmethod.mat');
% iscell=readNPY('L:\Monkey2\region1\20220428\iscell.npy');
% s0428=find(iscell(:,1)==1);
% 
% for i=1:length(M2region1day3)
% unbiased_previous_left0428new(i,:)=unbiased_previous_left0428(find(s0428==M2region1day3(i,7)),:);
% unbiased_previous_right0428new(i,:)=unbiased_previous_right0428(find(s0428==M2region1day3(i,7)),:);
% end
% 
% load('L:\Monkey2\region1\20220429\proportions_of_cells_encoding_previous_trials_outcome_20220429_newmethod.mat');
% iscell=readNPY('L:\Monkey2\region1\20220429\iscell.npy');
% s0429=find(iscell(:,1)==1);
% 
% for i=1:length(M2region1day4)
% unbiased_previous_left0429new(i,:)=unbiased_previous_left0429(find(s0429==M2region1day4(i,7)),:);
% unbiased_previous_right0429new(i,:)=unbiased_previous_right0429(find(s0429==M2region1day4(i,7)),:);
% end
% 
% 
% load('L:\Monkey2\region1\20220430\proportions_of_cells_encoding_previous_trials_outcome_20220430_newmethod.mat');
% iscell=readNPY('L:\Monkey2\region1\20220430\iscell.npy');
% s0430=find(iscell(:,1)==1);
% 
% for i=1:length(M2region1day5)
% unbiased_previous_left0430new(i,:)=unbiased_previous_left0430(find(s0430==M2region1day5(i,7)),:);
% unbiased_previous_right0430new(i,:)=unbiased_previous_right0430(find(s0430==M2region1day5(i,7)),:);
% end
% load('L:\Monkey2\region1\20220501\proportions_of_cells_encoding_previous_trials_outcome_20220501_newmethod.mat');
% iscell=readNPY('L:\Monkey2\region1\20220501\iscell.npy');
% s0501=find(iscell(:,1)==1);
% 
% for i=1:length(M2region1day6)
% unbiased_previous_left0501new(i,:)=unbiased_previous_left0501(find(s0501==M2region1day6(i,7)),:);
% unbiased_previous_right0501new(i,:)=unbiased_previous_right0501(find(s0501==M2region1day6(i,7)),:);
% end
% load('L:\Monkey2\region1\20220502\proportions_of_cells_encoding_previous_trials_outcome_20220502_newmethod.mat');
% iscell=readNPY('L:\Monkey2\region1\20220502\iscell.npy');
% s0502=find(iscell(:,1)==1);
% 
% for i=1:length(M2region1day7)
% unbiased_previous_left0502new(i,:)=unbiased_previous_left0502(find(s0502==M2region1day7(i,7)),:);
% unbiased_previous_right0502new(i,:)=unbiased_previous_right0502(find(s0502==M2region1day7(i,7)),:);
% end
% 
% %monkey2region2
% load('L:\Monkey2\region2\20220503\proportions_of_cells_encoding_previous_trials_outcome_20220503_newmethod.mat');
% iscell=readNPY('L:\Monkey2\region2\20220503\iscell.npy');
% s0503=find(iscell(:,1)==1);
% 
% for i=1:length(M2region2day1)
% unbiased_previous_left0503new(i,:)=unbiased_previous_left0503(find(s0503==M2region2day1(i,7)),:);
% unbiased_previous_right0503new(i,:)=unbiased_previous_right0503(find(s0503==M2region2day1(i,7)),:);
% end
% 
% load('L:\Monkey2\region2\20220504\proportions_of_cells_encoding_previous_trials_outcome_20220504_newmethod.mat');
% iscell=readNPY('L:\Monkey2\region2\20220504\iscell.npy');
% s0504=find(iscell(:,1)==1);
% 
% for i=1:length(M2region2day2)
% unbiased_previous_left0504new(i,:)=unbiased_previous_left0504(find(s0504==M2region2day2(i,7)),:);
% unbiased_previous_right0504new(i,:)=unbiased_previous_right0504(find(s0504==M2region2day2(i,7)),:);
% end
% load('L:\Monkey2\region2\20220505\proportions_of_cells_encoding_previous_trials_outcome_20220505_newmethod.mat');
% iscell=readNPY('L:\Monkey2\region2\20220505\iscell.npy');
% s0505=find(iscell(:,1)==1);
% 
% for i=1:length(M2region2day3)
% unbiased_previous_left0505new(i,:)=unbiased_previous_left0505(find(s0505==M2region2day3(i,7)),:);
% unbiased_previous_right0505new(i,:)=unbiased_previous_right0505(find(s0505==M2region2day3(i,7)),:);
% end
% 
% 
% load('L:\Monkey2\region2\20220506\proportions_of_cells_encoding_previous_trials_outcome_20220506_newmethod.mat');
% iscell=readNPY('L:\Monkey2\region2\20220506\iscell.npy');
% s0506=find(iscell(:,1)==1);
% 
% for i=1:length(M2region2day4)
% unbiased_previous_left0506new(i,:)=unbiased_previous_left0506(find(s0506==M2region2day4(i,7)),:);
% unbiased_previous_right0506new(i,:)=unbiased_previous_right0506(find(s0506==M2region2day4(i,7)),:);
% end
% 
% load('L:\Monkey2\region3\20220507\proportions_of_cells_encoding_previous_trials_outcome_20220507_newmethod.mat');
% iscell=readNPY('L:\Monkey2\region3\20220507\iscell.npy');
% s0507=find(iscell(:,1)==1);
% 
% for i=1:length(M2region3day1)
% unbiased_previous_left0507new(i,:)=unbiased_previous_left0507(find(s0507==M2region3day1(i,7)),:);
% unbiased_previous_right0507new(i,:)=unbiased_previous_right0507(find(s0507==M2region3day1(i,7)),:);
% end
% load('L:\Monkey2\region3\20220508\proportions_of_cells_encoding_previous_trials_outcome_20220508_newmethod.mat');
% iscell=readNPY('L:\Monkey2\region3\20220508\iscell.npy');
% s0508=find(iscell(:,1)==1);
% 
% for i=1:length(M2region3day2)
% unbiased_previous_left0508new(i,:)=unbiased_previous_left0508(find(s0508==M2region3day2(i,7)),:);
% unbiased_previous_right0508new(i,:)=unbiased_previous_right0508(find(s0508==M2region3day2(i,7)),:);
% end
% load('L:\Monkey2\region3\20220509\proportions_of_cells_encoding_previous_trials_outcome_20220509_newmethod.mat');
% iscell=readNPY('L:\Monkey2\region3\20220509\iscell.npy');
% s0509=find(iscell(:,1)==1);
% 
% for i=1:length(M2region3day3)
% unbiased_previous_left0509new(i,:)=unbiased_previous_left0509(find(s0509==M2region3day3(i,7)),:);
% unbiased_previous_right0509new(i,:)=unbiased_previous_right0509(find(s0509==M2region3day3(i,7)),:);
% end
% 
% load('L:\Monkey2\region3\20220510\proportions_of_cells_encoding_previous_trials_outcome_20220510_newmethod.mat');
% iscell=readNPY('L:\Monkey2\region3\20220510\iscell.npy');
% s0510=find(iscell(:,1)==1);
% 
% for i=1:size(M2region3day4,1)
% unbiased_previous_left0510new(i,:)=unbiased_previous_left0510(find(s0510==M2region3day4(i,7)),:);
% unbiased_previous_right0510new(i,:)=unbiased_previous_right0510(find(s0510==M2region3day4(i,7)),:);
% end
% 
% load('L:\Monkey2\region3\20220511\proportions_of_cells_encoding_previous_trials_outcome_20220511_newmethod.mat');
% iscell=readNPY('L:\Monkey2\region3\20220511\iscell.npy');
% s0511=find(iscell(:,1)==1);
% 
% for i=1:length(M2region3day5)
% unbiased_previous_left0511new(i,:)=unbiased_previous_left0511(find(s0511==M2region3day5(i,7)),:);
% unbiased_previous_right0511new(i,:)=unbiased_previous_right0511(find(s0511==M2region3day5(i,7)),:);
% end
% 
% 
% load('L:\Monkey2\region3\20220512\proportions_of_cells_encoding_previous_trials_outcome_20220512_newmethod.mat');
% iscell=readNPY('L:\Monkey2\region3\20220512\iscell.npy');
% s0512=find(iscell(:,1)==1);
% 
% for i=1:size(M2region3day6,1)
% unbiased_previous_left0512new(i,:)=unbiased_previous_left0512(find(s0512==M2region3day6(i,7)),:);
% unbiased_previous_right0512new(i,:)=unbiased_previous_right0512(find(s0512==M2region3day6(i,7)),:);
% end
% 
% load('L:\Monkey2\region3\20220513\proportions_of_cells_encoding_previous_trials_outcome_20220513_newmethod.mat');
% iscell=readNPY('L:\Monkey2\region3\20220513\iscell.npy');
% s0513=find(iscell(:,1)==1);
% 
% for i=1:length(M2region3day7)
% unbiased_previous_left0513new(i,:)=unbiased_previous_left0513(find(s0513==M2region3day7(i,7)),:);
% unbiased_previous_right0513new(i,:)=unbiased_previous_right0513(find(s0513==M2region3day7(i,7)),:);
% end
% load('L:\Monkey2\region4\20220517\proportions_of_cells_encoding_previous_trials_outcome_20220517_newmethod.mat');
% iscell=readNPY('L:\Monkey2\region4\20220517\iscell.npy');
% s0517=find(iscell(:,1)==1);
% 
% for i=1:length(M2region4day1)
% unbiased_previous_left0517new(i,:)=unbiased_previous_left0517(find(s0517==M2region4day1(i,7)),:);
% unbiased_previous_right0517new(i,:)=unbiased_previous_right0517(find(s0517==M2region4day1(i,7)),:);
% end
% load('L:\Monkey2\region4\20220518\proportions_of_cells_encoding_previous_trials_outcome_20220518_newmethod.mat');
% iscell=readNPY('L:\Monkey2\region4\20220518\iscell.npy');
% s0518=find(iscell(:,1)==1);
% 
% for i=1:length(M2region4day2)
% unbiased_previous_left0518new(i,:)=unbiased_previous_left0518(find(s0518==M2region4day2(i,7)),:);
% unbiased_previous_right0518new(i,:)=unbiased_previous_right0518(find(s0518==M2region4day2(i,7)),:);
% end
% 
% load('L:\Monkey2\region4\20220519\proportions_of_cells_encoding_previous_trials_outcome_20220519_newmethod.mat');
% iscell=readNPY('L:\Monkey2\region4\20220519\iscell.npy');
% s0519=find(iscell(:,1)==1);
% 
% for i=1:length(M2region4day3)
% unbiased_previous_left0519new(i,:)=unbiased_previous_left0519(find(s0519==M2region4day3(i,7)),:);
% 
% unbiased_previous_right0519new(i,:)=unbiased_previous_right0519(find(s0519==M2region4day3(i,7)),:);
% end
% 
% load('L:\Monkey2\region5\20220524\proportions_of_cells_encoding_previous_trials_outcome_20220524_newmethod.mat');
% iscell=readNPY('L:\Monkey2\region5\20220524\iscell.npy');
% s0524=find(iscell(:,1)==1);
% 
% for i=1:size(M2region5day1,1)
% unbiased_previous_left0524new(i,:)=unbiased_previous_left0524(find(s0524==M2region5day1(i,7)),:);
% unbiased_previous_right0524new(i,:)=unbiased_previous_right0524(find(s0524==M2region5day1(i,7)),:);
% end
% load('L:\Monkey2\region5\20220526\proportions_of_cells_encoding_previous_trials_outcome_20220526_newmethod.mat');
% iscell=readNPY('L:\Monkey2\region5\20220526\iscell.npy');
% s0526=find(iscell(:,1)==1);
% 
% for i=1:size(M2region5day2,1)
% unbiased_previous_left0526new(i,:)=unbiased_previous_left0526(find(s0526==M2region5day2(i,7)),:);
% unbiased_previous_right0526new(i,:)=unbiased_previous_right0526(find(s0526==M2region5day2(i,7)),:);
% end
% 
% load('L:\Monkey2\region5\20220527\proportions_of_cells_encoding_previous_trials_outcome_20220527_newmethod.mat');
% iscell=readNPY('L:\Monkey2\region5\20220527\iscell.npy');
% s0527=find(iscell(:,1)==1);
% 
% for i=1:length(M2region5day3)
% unbiased_previous_left0527new(i,:)=unbiased_previous_left0527(find(s0527==M2region5day3(i,7)),:);
% unbiased_previous_right0527new(i,:)=unbiased_previous_right0527(find(s0527==M2region5day3(i,7)),:);
% end
% load('L:\Monkey2\region5\20220528\proportions_of_cells_encoding_previous_trials_outcome_20220528_newmethod.mat');
% iscell=readNPY('L:\Monkey2\region5\20220528\iscell.npy');
% s0528=find(iscell(:,1)==1);
% 
% for i=1:length(M2region5day4)
% unbiased_previous_left0528new(i,:)=unbiased_previous_left0528(find(s0528==M2region5day4(i,7)),:);
% unbiased_previous_right0528new(i,:)=unbiased_previous_right0528(find(s0528==M2region5day4(i,7)),:);
% end
% load('L:\Monkey2\region5\20220529\proportions_of_cells_encoding_previous_trials_outcome_20220529_newmethod.mat');
% iscell=readNPY('L:\Monkey2\region5\20220529\iscell.npy');
% s0529=find(iscell(:,1)==1);
% 
% for i=1:length(M2region5day5)
% unbiased_previous_left0529new(i,:)=unbiased_previous_left0529(find(s0529==M2region5day5(i,7)),:);
% unbiased_previous_right0529new(i,:)=unbiased_previous_right0529(find(s0529==M2region5day5(i,7)),:);
% end
% load('L:\Monkey2\region5\20220530\proportions_of_cells_encoding_previous_trials_outcome_20220530_newmethod.mat');
% iscell=readNPY('L:\Monkey2\region5\20220530\iscell.npy');
% s0530=find(iscell(:,1)==1);
% 
% for i=1:size(M2region5day6,1)
% unbiased_previous_left0530new(i,:)=unbiased_previous_left0530(find(s0530==M2region5day6(i,7)),:);
% unbiased_previous_right0530new(i,:)=unbiased_previous_right0530(find(s0530==M2region5day6(i,7)),:);
% end
% load('L:\Monkey2\region6\20220610\proportions_of_cells_encoding_previous_trials_outcome_20220610_newmethod.mat');
% iscell=readNPY('L:\Monkey2\region6\20220610\iscell.npy');
% s0610=find(iscell(:,1)==1);
% 
% for i=1:size(M2region6day1,1)
% unbiased_previous_left0610new(i,:)=unbiased_previous_left0610(find(s0610==M2region6day1(i,7)),:);
% unbiased_previous_right0610new(i,:)=unbiased_previous_right0610(find(s0610==M2region6day1(i,7)),:);
% end
% load('L:\Monkey2\region6\20220611\proportions_of_cells_encoding_previous_trials_outcome_20220611_newmethod.mat');
% iscell=readNPY('L:\Monkey2\region6\20220611\iscell.npy');
% s0611=find(iscell(:,1)==1);
% 
% for i=1:length(M2region6day2)
% unbiased_previous_left0611new(i,:)=unbiased_previous_left0611(find(s0611==M2region6day2(i,7)),:);
% unbiased_previous_right0611new(i,:)=unbiased_previous_right0611(find(s0611==M2region6day2(i,7)),:);
% end
% 
% 
% load('L:\Monkey2\region6\20220612\proportions_of_cells_encoding_previous_trials_outcome_20220612_newmethod.mat');
% iscell=readNPY('L:\Monkey2\region6\20220612\iscell.npy');
% s0612=find(iscell(:,1)==1);
% 
% for i=1:length(M2region6day3)
% unbiased_previous_left0612new(i,:)=unbiased_previous_left0612(find(s0612==M2region6day3(i,7)),:);
% unbiased_previous_right0612new(i,:)=unbiased_previous_right0612(find(s0612==M2region6day3(i,7)),:);
% end
% 
% load('L:\Monkey2\region6\20220613\proportions_of_cells_encoding_previous_trials_outcome_20220613_newmethod.mat');
% iscell=readNPY('L:\Monkey2\region6\20220613\iscell.npy');
% s0613=find(iscell(:,1)==1);
% 
% for i=1:length(M2region6day4)
% unbiased_previous_left0613new(i,:)=unbiased_previous_left0613(find(s0613==M2region6day4(i,7)),:);
% unbiased_previous_right0613new(i,:)=unbiased_previous_right0613(find(s0613==M2region6day4(i,7)),:);
% end
% 
% load('L:\Monkey2\region7\20220618\proportions_of_cells_encoding_previous_trials_outcome_20220618_newmethod.mat');
% iscell=readNPY('L:\Monkey2\region7\20220618\iscell.npy');
% s0618=find(iscell(:,1)==1);
% 
% for i=1:length(M2region7day1)
% unbiased_previous_left0618new(i,:)=unbiased_previous_left0618(find(s0618==M2region7day1(i,7)),:);
% unbiased_previous_right0618new(i,:)=unbiased_previous_right0618(find(s0618==M2region7day1(i,7)),:);
% end
% 
% load('L:\Monkey2\region7\20220619\proportions_of_cells_encoding_previous_trials_outcome_20220619_newmethod.mat');
% iscell=readNPY('L:\Monkey2\region7\20220619\iscell.npy');
% s0619=find(iscell(:,1)==1);
% 
% for i=1:size(M2region7day2,1)
% unbiased_previous_left0619new(i,:)=unbiased_previous_left0619(find(s0619==M2region7day2(i,7)),:);
% unbiased_previous_right0619new(i,:)=unbiased_previous_right0619(find(s0619==M2region7day2(i,7)),:);
% end
% load('L:\Monkey2\region7\20220620\proportions_of_cells_encoding_previous_trials_outcome_20220620_newmethod.mat');
% iscell=readNPY('L:\Monkey2\region7\20220620\iscell.npy');
% s0620=find(iscell(:,1)==1);
% 
% for i=1:size(M2region7day3,1)
% unbiased_previous_left0620new(i,:)=unbiased_previous_left0620(find(s0620==M2region7day3(i,7)),:);
% unbiased_previous_right0620new(i,:)=unbiased_previous_right0620(find(s0620==M2region7day3(i,7)),:);
% end
% load('L:\Monkey2\region7\20220621\proportions_of_cells_encoding_previous_trials_outcome_20220621_newmethod.mat');
% iscell=readNPY('L:\Monkey2\region7\20220621\iscell.npy');
% s0621=find(iscell(:,1)==1);
% 
% for i=1:size(M2region7day4,1)
% unbiased_previous_left0621new(i,:)=unbiased_previous_left0621(find(s0621==M2region7day4(i,7)),:);
% unbiased_previous_right0621new(i,:)=unbiased_previous_right0621(find(s0621==M2region7day4(i,7)),:);
% end
% 
% load('L:\Monkey2\region7\20220622\proportions_of_cells_encoding_previous_trials_outcome_20220622_newmethod.mat');
% iscell=readNPY('L:\Monkey2\region7\20220622\iscell.npy');
% s0622=find(iscell(:,1)==1);
% 
% for i=1:size(M2region7day5,1)
% unbiased_previous_left0622new(i,:)=unbiased_previous_left0622(find(s0622==M2region7day5(i,7)),:);
% unbiased_previous_right0622new(i,:)=unbiased_previous_right0622(find(s0622==M2region7day5(i,7)),:);
% end
% load('L:\Monkey2\region7\20220623\proportions_of_cells_encoding_previous_trials_outcome_20220623_newmethod.mat');
% iscell=readNPY('L:\Monkey2\region7\20220623\iscell.npy');
% s0623=find(iscell(:,1)==1);
% 
% for i=1:length(M2region7day6)
% unbiased_previous_left0623new(i,:)=unbiased_previous_left0623(find(s0623==M2region7day6(i,7)),:);
% unbiased_previous_right0623new(i,:)=unbiased_previous_right0623(find(s0623==M2region7day6(i,7)),:);
% end
% load('L:\Monkey2\region8\20220624\proportions_of_cells_encoding_previous_trials_outcome_20220624_newmethod.mat');
% iscell=readNPY('L:\Monkey2\region8\20220624\iscell.npy');
% s0624=find(iscell(:,1)==1);
% 
% for i=1:length(M2region8day1)
% unbiased_previous_left0624new(i,:)=unbiased_previous_left0624(find(s0624==M2region8day1(i,7)),:);
% unbiased_previous_right0624new(i,:)=unbiased_previous_right0624(find(s0624==M2region8day1(i,7)),:);
% end
% 
% load('L:\Monkey2\region8\20220627\proportions_of_cells_encoding_previous_trials_outcome_20220627_newmethod.mat');
% iscell=readNPY('L:\Monkey2\region8\20220627\iscell.npy');
% s0627=find(iscell(:,1)==1);
% 
% for i=1:length(M2region8day2)
% unbiased_previous_left0627new(i,:)=unbiased_previous_left0627(find(s0627==M2region8day2(i,7)),:);
% unbiased_previous_right0627new(i,:)=unbiased_previous_right0627(find(s0627==M2region8day2(i,7)),:);
% end
% 
% load('L:\Monkey2\region8\20220628\proportions_of_cells_encoding_previous_trials_outcome_20220628_newmethod.mat');
% iscell=readNPY('L:\Monkey2\region8\20220628\iscell.npy');
% s0628=find(iscell(:,1)==1);
% 
% for i=1:length(M2region8day3)
% unbiased_previous_left0628new(i,:)=unbiased_previous_left0628(find(s0628==M2region8day3(i,7)),:);
% unbiased_previous_right0628new(i,:)=unbiased_previous_right0628(find(s0628==M2region8day3(i,7)),:);
% end
% 
% load('L:\Monkey2\region8\20220629\proportions_of_cells_encoding_previous_trials_outcome_20220629_newmethod.mat');
% iscell=readNPY('L:\Monkey2\region8\20220629\iscell.npy');
% s0629=find(iscell(:,1)==1);
% 
% for i=1:length(M2region8day4)
% unbiased_previous_left0629new(i,:)=unbiased_previous_left0629(find(s0629==M2region8day4(i,7)),:);
% unbiased_previous_right0629new(i,:)=unbiased_previous_right0629(find(s0629==M2region8day4(i,7)),:);
% end
% 
% load('L:\Monkey2\region8\20220630\proportions_of_cells_encoding_previous_trials_outcome_20220630_newmethod.mat');
% iscell=readNPY('L:\Monkey2\region8\20220630\iscell.npy');
% s0630=find(iscell(:,1)==1);
% 
% for i=1:length(M2region8day5)
% unbiased_previous_right0630new(i,:)=unbiased_previous_right0630(find(s0630==M2region8day5(i,7)),:);
% unbiased_previous_left0630new(i,:)=unbiased_previous_left0630(find(s0630==M2region8day5(i,7)),:);
% end
% 
% 



unbiased_previous_leftnew=[unbiased_previous_left1108new;unbiased_previous_left1109new;unbiased_previous_left1110new;unbiased_previous_left1111new;unbiased_previous_left1112new;unbiased_previous_left1113new;unbiased_previous_left1115new;unbiased_previous_left1116new;unbiased_previous_left1117new;unbiased_previous_left1118new;unbiased_previous_left1119new;unbiased_previous_left1122new;unbiased_previous_left1120new;unbiased_previous_left1121new;unbiased_previous_left1123new;unbiased_previous_left1124new;unbiased_previous_left1125new;unbiased_previous_left1126new;unbiased_previous_left1127new;unbiased_previous_left1129new;unbiased_previous_left1201new;unbiased_previous_left1202new;unbiased_previous_left1203new;unbiased_previous_left1204new;unbiased_previous_left1217new;unbiased_previous_left1218new;unbiased_previous_left1219new;unbiased_previous_left1220new;unbiased_previous_left1221new;unbiased_previous_left1222new;unbiased_previous_left1223new;unbiased_previous_left1224new;unbiased_previous_left1225new;unbiased_previous_left1226new;unbiased_previous_left0115new;unbiased_previous_left0116new;unbiased_previous_left0117new];
unbiased_previous_rightnew=[unbiased_previous_right1108new;unbiased_previous_right1109new;unbiased_previous_right1110new;unbiased_previous_right1111new;unbiased_previous_right1112new;unbiased_previous_right1113new;unbiased_previous_right1115new;unbiased_previous_right1116new;unbiased_previous_right1117new;unbiased_previous_right1118new;unbiased_previous_right1119new;unbiased_previous_right1122new;unbiased_previous_right1120new;unbiased_previous_right1121new;unbiased_previous_right1123new;unbiased_previous_right1124new;unbiased_previous_right1125new;unbiased_previous_right1126new;unbiased_previous_right1127new;unbiased_previous_right1129new;unbiased_previous_right1201new;unbiased_previous_right1202new;unbiased_previous_right1203new;unbiased_previous_right1204new;unbiased_previous_right1217new;unbiased_previous_right1218new;unbiased_previous_right1219new;unbiased_previous_right1220new;unbiased_previous_right1221new;unbiased_previous_right1222new;unbiased_previous_right1223new;unbiased_previous_right1224new;unbiased_previous_right1225new;unbiased_previous_right1226new;unbiased_previous_right0115new;unbiased_previous_right0116new;unbiased_previous_right0117new];


shadedErrorBar(([1:40]-20)/7.4,mean(unbiased_previous_leftnew(:,1:40),1),std(unbiased_previous_leftnew(:,1:40),1)./sqrt(length(unbiased_previous_leftnew(:,1:40))),'lineProps','r');
xline(0);
hold on
shadedErrorBar(([1:40]-20)/7.4,mean(unbiased_previous_rightnew(:,1:40),1),std(unbiased_previous_rightnew(:,1:40),1)./sqrt(length(unbiased_previous_rightnew(:,1:40))),'lineProps','k');
legend('left','right');
ylim([0 0.02]);



p = kruskalwallis([mean(unbiased_previous_leftnew(:,9:32),2)],[mean(unbiased_previous_rightnew(:,9:32),2)],'off');


mean_unbiased_previous_leftnew=mean(mean(unbiased_previous_leftnew(:,9:32),2));
std_unbiased_previous_leftnew=std(std(unbiased_previous_leftnew(:,9:32),0,2))/sqrt(length(unbiased_previous_leftnew));




mean_unbiased_previous_rightnew=mean(mean(unbiased_previous_rightnew(:,9:32),2));
std_unbiased_previous_rightnew=std(std(unbiased_previous_rightnew(:,9:32),0,2))/sqrt(length(unbiased_previous_rightnew));



figure
bar(1,mean_unbiased_previous_leftnew)
hold on
bar(2,mean_unbiased_previous_rightnew)

hold on
errorbar(1,mean_unbiased_previous_leftnew,std_unbiased_previous_leftnew,'k');
hold on
errorbar(2,mean_unbiased_previous_rightnew,std_unbiased_previous_rightnew,'k');
